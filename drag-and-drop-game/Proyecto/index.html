<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Prosegur - Drag and Drop Game</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-color: #1a1a2e;
      font-family: 'Roboto', Arial, sans-serif;
    }

    #game-wrapper {
      position: relative;
      width: 300px;
      height: 600px;
      background-color: #ffd000;
      border-radius: 0;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    /* ===== DOM HEADER ELEMENTS ===== */
    #dom-header {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 100;
      padding: 15px 20px;
      pointer-events: none;
    }

    #logo-container {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
    }

    #logo-container img {
      height: 20px;
      width: auto;
    }

    #title-container {
      text-align: center;
    }

    #title-container img {
      max-width: 90%;
      height: auto;
    }

    #subtitle-container {
      text-align: center;
      margin-top: 5px;
    }

    #subtitle-container img {
      max-width: 85%;
      height: auto;
    }

    /* ===== GAME CONTAINER ===== */
    #game-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    #game-container canvas {
      display: block;
    }

    /* ===== DOM FOOTER ELEMENTS ===== */
    #dom-footer {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      z-index: 100;
      padding: 15px 20px;
      pointer-events: none;
    }

    #progress-container {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 8px;
      margin-bottom: 15px;
    }

    #progress-label {
      font-size: 11px;
      color: #333;
      font-weight: 400;
      line-height: 1.2;
    }

    #progress-icons {
      display: flex;
      gap: 4px;
    }

    .progress-icon {
      width: 24px;
      height: 24px;
      transition: all 0.3s ease;
    }

    .progress-icon.empty {
      opacity: 0.3;
      filter: grayscale(100%);
    }

    .progress-icon.filled {
      opacity: 1;
      filter: none;
      transform: scale(1.1);
    }

    #cta-container {
      text-align: center;
      pointer-events: auto;
    }

    #cta-button {
      background-color: #333;
      color: #ffd000;
      border: none;
      padding: 12px 40px;
      font-size: 16px;
      font-weight: 700;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Roboto', Arial, sans-serif;
    }

    #cta-button:hover {
      background-color: #000;
      transform: scale(1.05);
    }

    /* ===== INFO POPUP ===== */
    #info-popup {
      position: absolute;
      z-index: 200;
      background-color: #333;
      color: #fff;
      padding: 12px 15px;
      border-radius: 8px;
      max-width: 140px;
      font-size: 11px;
      line-height: 1.4;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.3s ease;
      pointer-events: none;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    #info-popup.visible {
      opacity: 1;
      transform: translateY(0);
    }

    #info-popup h4 {
      font-size: 13px;
      font-weight: 700;
      margin-bottom: 5px;
      color: #ffd000;
    }

    #info-popup p {
      margin: 0;
      font-weight: 400;
    }

    /* ===== INFO POPUP ARROW ===== */
    #info-popup::before {
      content: '';
      position: absolute;
      top: -8px;
      left: 20px;
      border-left: 8px solid transparent;
      border-right: 8px solid transparent;
      border-bottom: 8px solid #333;
    }
  </style>
</head>
<body>
  <script>
    /**
     * =====================================================
     * CONFIGURACION DEL JUEGO PROSEGUR - DRAG AND DROP
     * =====================================================
     */
    window.GAME_CONFIG = {

      // ===================================================
      // DIMENSIONES DEL JUEGO
      // ===================================================
      width: 300,
      height: 600,

      // ===================================================
      // INDICADOR DE ARRASTRE (Icon_Drag)
      // ===================================================
      dragIndicator: {
        enabled: true,
        key: "icon-drag",
        path: "Icon_Drag.png",
        scale: 0.6,
        x: 200,                         // Posicion X del indicador
        y: 280                          // Posicion Y del indicador
      },

      // ===================================================
      // FONDO DEL JUEGO
      // ===================================================
      background: {
        color: "#ffd000",
        image: null,          // Key de imagen de fondo (null = solo color)
        imagePath: null       // Ruta de la imagen de fondo
      },

      // ===================================================
      // CONTENEDOR (PlanoCasa - donde se sueltan los items)
      // ===================================================
      container: {
        key: "plano-casa",
        path: "PlanoCasa.png",
        scale: 0.25,
        y: 340
      },

      // ===================================================
      // CIRCULOS DE DROP ZONE (configuracion global)
      // ===================================================
      dropZones: {
        circleKey: "circle-select",
        circlePath: "CirculoSelect.png",
        circleScale: 1,
        dropRadius: 35
      },

      // ===================================================
      // ITEMS ARRASTRABLES
      // ===================================================
      // Cada item tiene su posicion (x, y), dropZone y showDescription
      itemCount: 3,
      assetsPath: "assets/",

      items: [
        {
          key: "camara",
          path: "CamaraSeguridad.png",
          title: "Camara de\nSeguridad",
          description: "Monitoreo 24/7 con video en tiempo real conectado a la central de Prosegur",
          showDescription: true,
          scale: 1,                      // Escala del item arrastrando
          dropScale: 0.7,                // Escala del item despues del drop
          x: 55,
          y: 200,
          dropZone: { x: 80, y: 300 }
        },
        {
          key: "panel",
          path: "PanelCentral.png",
          title: "Panel\nCentral",
          description: "Es el cerebro del Sistema de alarmas conectando con la central de monitoreo de Prosegur",
          showDescription: true,
          scale: 1,
          dropScale: 0.7,
          x: 150,
          y: 200,
          dropZone: { x: 220, y: 300 }
        },
        {
          key: "detector",
          path: "Detector.png",
          title: "Detectores de\nmovimiento",
          description: "Sensores inteligentes que detectan cualquier movimiento sospechoso en tu hogar",
          showDescription: true,
          scale: 1,
          dropScale: 0.5,
          x: 245,
          y: 200,
          dropZone: { x: 210, y: 350 }
        }
      ],

      // ===================================================
      // POPUP DE INFORMACION
      // ===================================================
      infoPopup: {
        enabled: true,
        showDuration: 7000,
        backgroundColor: "#333",      // Fondo del popup
        titleColor: "#ffd000",        // Color del titulo
        descriptionColor: "#fff"      // Color de la descripcion
      },

      // ===================================================
      // ANIMACIONES
      // ===================================================
      animations: {
        itemEntry: {
          duration: 400,
          ease: "Back.easeOut",
          stagger: 100
        },
        dropSuccess: {
          scaleBounce: 1.2,
          duration: 200,
          particleCount: 6
        },
        drag: {
          scale: 1.15,
          alpha: 0.9
        }
      },

      // ===================================================
      // CALLBACKS
      // ===================================================
      endGameCallback: null
    };
  </script>

  <div id="game-wrapper">
    <!-- DOM Header: Logo, Title, Subtitle -->
    <div id="dom-header">
      <div id="logo-container">
        <img src="assets/logo-prosegur.png" alt="Prosegur">
      </div>
      <div id="title-container">
        <img src="assets/title_Text_Activa_.png" alt="Arrastra. Protege. Activa.">
      </div>
      <div id="subtitle-container">
        <img src="assets/subtitle.png" alt="Ubica cada sistema en el lugar correcto">
      </div>
    </div>

    <!-- Game Canvas -->
    <div id="game-container"></div>

    <!-- DOM Footer: Progress Bar, CTA -->
    <div id="dom-footer">
      <div id="progress-container">
        <span id="progress-label">Nivel de<br>seguridad:</span>
        <div id="progress-icons">
          <img class="progress-icon empty" id="progress-icon-0" src="assets/Seguridad_Icon.png">
          <img class="progress-icon empty" id="progress-icon-1" src="assets/Seguridad_Icon.png">
          <img class="progress-icon empty" id="progress-icon-2" src="assets/Seguridad_Icon.png">
        </div>
      </div>
      <div id="cta-container">
        <button id="cta-button" onclick="console.log('CTA clicked!')">Cotiza ahora</button>
      </div>
    </div>

    <!-- Info Popup (hidden by default) -->
    <div id="info-popup">
      <h4 id="popup-title"></h4>
      <p id="popup-description"></p>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
  <script src="main.js"></script>

  <script>
    const cfg = window.GAME_CONFIG;

    // Global function to update progress from Phaser
    window.updateDOMProgress = function(index) {
      const icon = document.getElementById(`progress-icon-${index}`);
      if (icon) {
        icon.classList.remove('empty');
        icon.classList.add('filled');
      }
    };

    // Global function to show info popup
    window.showInfoPopup = function(title, description, x, y) {
      const popup = document.getElementById('info-popup');
      const popupTitle = document.getElementById('popup-title');
      const popupDesc = document.getElementById('popup-description');

      popupTitle.textContent = title;
      popupDesc.textContent = description;

      // Apply styles from config
      popup.style.backgroundColor = cfg.infoPopup.backgroundColor || '#333';
      popupTitle.style.color = cfg.infoPopup.titleColor || '#ffd000';
      popupDesc.style.color = cfg.infoPopup.descriptionColor || '#fff';

      // Position popup
      popup.style.left = Math.max(10, Math.min(x - 70, 160)) + 'px';
      popup.style.top = (y + 20) + 'px';

      popup.classList.add('visible');

      // Auto-hide after duration
      setTimeout(() => {
        popup.classList.remove('visible');
      }, cfg.infoPopup.showDuration);
    };

    // Initialize Phaser game
    const config = {
      type: Phaser.AUTO,
      width: cfg.width,
      height: cfg.height,
      parent: 'game-container',
      transparent: true,
      scene: [PreloaderScene, GameScene]
    };

    window.game = new Phaser.Game(config);
  </script>
</body>
</html>
